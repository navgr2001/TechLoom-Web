(function(){"use strict";var a=function(a,b){function c(){var a=d.querySelectorAll(".tpae-form-field");a.forEach(a=>{let b=a.getAttribute("data-tablet-width"),c=a.getAttribute("data-mobile-width"),d=a.getAttribute("data-width");a.style.width=768>window.innerWidth?c+"%":1024>=window.innerWidth?b+"%":d+"%"})}var d=a[0].querySelector(".tpae-form-container"),e=d.querySelector(".tpae-form"),f=d.dataset.formdata?JSON.parse(d.dataset.formdata):{},g=f.Required_mask,h=d?.dataset?.emaildata?JSON.parse(d.dataset.emaildata):{},i=d.querySelectorAll(".tpae-required-asterisk");i.forEach(function(a){a.style.display="hide-asterisks"===g?"none":"inline"});var j=f.invalid_form||"Invalid form submission.",k=f.success_message||"Your message has been sent successfully.",l=f.form_error||"There was an error with the form submission.",m=f.required_fields||"Please fill in the required fields.",n=f.email_format_error||"Please enter a valid email address.",o=f.server_error||"Server error, please try again later.",p=!1,q=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;e.querySelectorAll("input[type=\"email\"], input[name*=\"email\"], input[id*=\"email\"]").forEach(function(a){a.addEventListener("blur",function(){var a=this.value.trim();""===a||q.test(a)?t(this):s(this,n)}),a.addEventListener("input",function(){t(this)})}),e.addEventListener("submit",function(a){if(a.preventDefault(),!p){p=!0,u();var b=!0,c={},d=[];return e.querySelectorAll(".tpae-form-field").forEach(function(a){var e=a.querySelector("input, textarea"),f=a.querySelector("label")?a.querySelector("label").textContent.trim():"";if(e){var g=e.value.trim(),h=e.getAttribute("id")||"",i=e.getAttribute("name")||"",j=e.getAttribute("type")||"";d.push({field_id:h,field_name:i,field_value:g}),e.required&&""===g&&(b=!1,s(e,m.replace("%field%",f)));var k="email"===j||i.toLowerCase().includes("email")||h.toLowerCase().includes("email")||f.toLowerCase().includes("email");k&&""!==g&&!q.test(g)&&(b=!1,s(e,n)),c[e.name||f||e.id]=g}}),b?void r(c,d):(v(j,"error"),p=!1,!1)}});var r=function(a,c){var d=e.querySelector(".tpae-form-submit"),f=d.querySelector(".tpae-button-text"),g=d.querySelector(".tpae-button-loader");return d.disabled=!0,f&&(f.style.display="none"),g&&(g.style.display="inline-flex"),b.ajax({url:theplus_ajax_url,type:"POST",data:{action:"tpae_form_submission",form_data:JSON.stringify(a),email_data:h,form_fields:JSON.stringify(c),security:h.nonce},success:function(a){if(!a?.success)v(l.replace("%error%",a?.data?.message),"error");else if(a?.data?.email_sent){v(k,"success"),e.reset();var b=a?.data?.redirection;b&&b.url&&(b.is_external?window.open(b.url,"_blank","noopener,noreferrer"):window.location.href=b.url)}else v("Emails could not be sent. Please try again.","error")},error:function(a,b,c){v(o.replace("%error%",c),"error")},complete:function(){p=!1,g&&(g.style.display="none"),f&&(f.style.display="inline-block"),d.disabled=!1}}),!1},s=function(a,b){t(a);var c=document.createElement("span");c.className="tpae-field-error",c.style.color="red",c.textContent=b,a.parentElement.appendChild(c)},t=function(a){var b=a.parentElement.querySelector(".tpae-field-error");b&&b.remove()},u=function(){e.querySelectorAll(".tpae-form-messages").forEach(function(a){a.remove()}),e.querySelectorAll(".tpae-field-error").forEach(function(a){a.remove()})},v=function(a,b){b=b||"success",u();var c=document.createElement("div");c.className="tpae-form-message "+b,c.style.color="success"===b?"green":"red",c.textContent=a,e.appendChild(c)};c(),window.addEventListener("resize",c)};window.addEventListener("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/tp-plus-form.default",a)})})(jQuery);